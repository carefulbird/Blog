<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>非严格等和加法的&#39;潜规则&#39; | 宁采桃花不采臣</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="操千曲而后晓声，观千剑而后识器">
    <meta property="og:url" content="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2.html">
    <meta property="og:site_name" content="宁采桃花不采臣">
    <meta property="og:title" content="非严格等和加法的'潜规则'">
    <meta property="og:description" content="非严格等和加法的'潜规则' 记得在某次面试的时候，面试官问了我一个问题，即![]的答案是多少，当然，对于自认为把 JavaScript 学的还算可以的我来说不是什么问题，立即回答 false，因为一切对象转换为布尔值都是true。还不算完，接着立即问了我下一个问题，true == [] 吗？这问的有点懵，有点不知所措，不确定的答到是的，然后就回答了一些稀奇古">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="宁采桃花不采臣">
    <meta property="article:author" content="李豪">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.fdb7cbd9.css" as="style"><link rel="preload" href="/assets/js/app.ae2d76ca.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.8e38df49.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.f39ab126.js" as="script"><link rel="preload" href="/assets/js/page-非严格等和加法的'潜规则'.c3acfd97.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.778738f3.js" as="script"><link rel="prefetch" href="/assets/js/16.9290addc.js"><link rel="prefetch" href="/assets/js/17.506b35cf.js"><link rel="prefetch" href="/assets/js/18.d664c0c4.js"><link rel="prefetch" href="/assets/js/19.056d39b3.js"><link rel="prefetch" href="/assets/js/20.2fa30061.js"><link rel="prefetch" href="/assets/js/21.0e1c3449.js"><link rel="prefetch" href="/assets/js/22.b412fa8a.js"><link rel="prefetch" href="/assets/js/23.5a0597bb.js"><link rel="prefetch" href="/assets/js/24.97dea411.js"><link rel="prefetch" href="/assets/js/25.229b2ce2.js"><link rel="prefetch" href="/assets/js/26.4b1f36ab.js"><link rel="prefetch" href="/assets/js/27.ab49aa00.js"><link rel="prefetch" href="/assets/js/28.d32b9696.js"><link rel="prefetch" href="/assets/js/29.286a594e.js"><link rel="prefetch" href="/assets/js/30.ae09d987.js"><link rel="prefetch" href="/assets/js/31.23fb7825.js"><link rel="prefetch" href="/assets/js/32.e83c95f1.js"><link rel="prefetch" href="/assets/js/33.99d16f05.js"><link rel="prefetch" href="/assets/js/34.f61786c1.js"><link rel="prefetch" href="/assets/js/35.0d750c11.js"><link rel="prefetch" href="/assets/js/36.b20398c6.js"><link rel="prefetch" href="/assets/js/37.8f3fbef5.js"><link rel="prefetch" href="/assets/js/38.8ba581a8.js"><link rel="prefetch" href="/assets/js/39.1fde6ba9.js"><link rel="prefetch" href="/assets/js/40.b30bcc71.js"><link rel="prefetch" href="/assets/js/41.2e14dd95.js"><link rel="prefetch" href="/assets/js/42.73ee54e6.js"><link rel="prefetch" href="/assets/js/43.3703aea6.js"><link rel="prefetch" href="/assets/js/44.1525a303.js"><link rel="prefetch" href="/assets/js/45.5cd3a375.js"><link rel="prefetch" href="/assets/js/46.2d8158e6.js"><link rel="prefetch" href="/assets/js/47.2721d6d1.js"><link rel="prefetch" href="/assets/js/48.347928a4.js"><link rel="prefetch" href="/assets/js/49.789c6010.js"><link rel="prefetch" href="/assets/js/layout-Blog.a439bebd.js"><link rel="prefetch" href="/assets/js/layout-Layout.9c2c084f.js"><link rel="prefetch" href="/assets/js/layout-NotFound.3014de88.js"><link rel="prefetch" href="/assets/js/layout-Slide.2f38bd31.js"><link rel="prefetch" href="/assets/js/mermaid.3ab31ceb.js"><link rel="prefetch" href="/assets/js/page-Home.0eb5d59a.js"><link rel="prefetch" href="/assets/js/page-Javascrit.4b29b0f6.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f6885c5b.js"><link rel="prefetch" href="/assets/js/vendors~mermaid.4e0b3ba0.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.a225a2b8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fdb7cbd9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><!----> <!----> <span class="site-name can-hide">宁采桃花不采臣</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title"><i class="iconfont icon-front-end"></i>
        大前端
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/JavaScript/" class="nav-link router-link-active active"><i class="iconfont icon-Bomb"></i>
  JavaScript
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  主页
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title"><i class="iconfont icon-front-end"></i>
      大前端
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaScript/" class="nav-link router-link-active active"><i class="iconfont icon-Bomb"></i>
  JavaScript
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span class="title">语法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" aria-current="page" class="active sidebar-link">JS 类型转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#js的隐式转换" class="sidebar-link">JS的隐式转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#什么是隐式转换" class="sidebar-link heading3">什么是隐式转换</a></li></ul></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#基本知识" class="sidebar-link">基本知识</a></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#toprimitive-input-preferredtype" class="sidebar-link">ToPrimitive ( input [ , PreferredType ] )</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#tonumber" class="sidebar-link heading3">ToNumber()</a></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#toboolean" class="sidebar-link heading3">ToBoolean()</a></li></ul></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#场景分析" class="sidebar-link">场景分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#严格等的比较分析" class="sidebar-link heading3">=== 严格等的比较分析</a></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#抽象等的比较分析" class="sidebar-link heading3">== 抽象等的比较分析</a></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#运算符的操作过程" class="sidebar-link heading3">+ 运算符的操作过程</a></li></ul></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#最后" class="sidebar-link">最后</a></li><li class="sidebar-sub-header"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#参考链接" class="sidebar-link">参考链接</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><!----> <span class="title">进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable open"><!----> <span class="title"></span> <span class="arrow down"></span></p> <!----></section></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/JavaScript/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">Javascrit</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">非严格等和加法的'潜规则'</span></a> <meta property="position" content="2"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">非严格等和加法的'潜规则'</span></h1> <div class="page-info"><!----> <!----><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-10-15</span></span><!----><!----><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 15 min</span> <meta property="timeRequired" content="PT15M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#js的隐式转换" class="anchor-link heading2"><div>JS的隐式转换</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#什么是隐式转换" class="anchor-link heading3"><div>什么是隐式转换</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#基本知识" class="anchor-link heading2"><div>基本知识</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#toprimitive-input-preferredtype" class="anchor-link heading2"><div>ToPrimitive ( input [ , PreferredType ] )</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#tonumber" class="anchor-link heading3"><div>ToNumber()</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#toboolean" class="anchor-link heading3"><div>ToBoolean()</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#场景分析" class="anchor-link heading2"><div>场景分析</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#严格等的比较分析" class="anchor-link heading3"><div>=== 严格等的比较分析</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#抽象等的比较分析" class="anchor-link heading3"><div>== 抽象等的比较分析</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#运算符的操作过程" class="anchor-link heading3"><div>+ 运算符的操作过程</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#最后" class="anchor-link heading2"><div>最后</div></a></li><li class="anchor"><a href="/JavaScript/JS%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/#参考链接" class="anchor-link heading2"><div>参考链接</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="非严格等和加法的-潜规则"><a href="#非严格等和加法的-潜规则" class="header-anchor">#</a> 非严格等和加法的'潜规则'</h1> <p>记得在某次面试的时候，面试官问了我一个问题，即![]的答案是多少，当然，对于自认为把 JavaScript 学的还算可以的我来说不是什么问题，立即回答 false，因为一切对象转换为布尔值都是true。还不算完，接着立即问了我下一个问题，true == [] 吗？这问的有点懵，有点不知所措，不确定的答到是的，然后就回答了一些稀奇古怪的东西，反正就是不怎么了解慌张应付。当然，答案是错误的，为了心中的求知欲，我在网上找了大量的资料，写了很多 demo ，终于总结出一份还算满意的js隐式转换的逻辑和步骤，接下来，为你呈现~</p> <h2 id="js的隐式转换"><a href="#js的隐式转换" class="header-anchor">#</a> JS的隐式转换</h2> <p>要说到 JS 这门语言的特点，可以说是非常的多了，不过最让人印象深刻的莫过于上手容易不需要像强类型语言那样申明变量和计算比较繁琐。但是在使用过程中有一件事儿是让人头疼的，就是为了可以让不同类型的变量进行直接操作就要进行大量的隐式转换，其中的规则也不是特别清晰，特别是当你刚刚接触这门语言的时候。本篇文章以介绍最为常见的 == 和 + 为你揭开隐式转换的神秘面纱。</p> <h3 id="什么是隐式转换"><a href="#什么是隐式转换" class="header-anchor">#</a> 什么是隐式转换</h3> <p>到底什么是隐式转换。简单的一句话可以概括。</p> <p>隐式转换：<strong>在不同类型的操作数运算时为了让它们能够正常运行得到正确的结果，将其中一个或者多个操作数转换为同一类型的动作就是隐式转换</strong>。</p> <p>当然，这也是JS的特色了，学习成本相比较于其他强类型的语言来说很低了，但是学到后面的坑也是一样的多。特别是早期的JS，大部分的函数都包含有隐式转换，直到后面ECMAScript的演进，倾向于将错误给抛出来
<img src="http://note.youdao.com/yws/res/1054/WEBRESOURCE2f1b58661ef286d1ab3c37d87c607d41" alt="image.png">
这个图是TypeError关键字在 <a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener noreferrer">ECMAScript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 文档出现的次数，也就是说后面的标准文档更倾向于将这个类型转换的错误给用户抛出来而不是向以前那样进行一个隐式转换。</p> <h2 id="基本知识"><a href="#基本知识" class="header-anchor">#</a> 基本知识</h2> <p>要了解隐式转换需要提前知道以下几个概念</p> <h2 id="toprimitive-input-preferredtype"><a href="#toprimitive-input-preferredtype" class="header-anchor">#</a> ToPrimitive ( input [ , PreferredType ] )</h2> <p>要提到隐式转换，不得不提及的一个函数就是 ToPrimitive() ,当然在 <a href="https://262.ecma-international.org/6.0/#sec-toprimitive" target="_blank" rel="noopener noreferrer">ECMAScript sec-toprimitive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的文档上对该函数也有非常详细的解释，这里用一个流程图来说明一下它的特性。</p> <p><img src="http://note.youdao.com/yws/res/300/WEBRESOURCEaaff2deee44a87331a5b868679e2e433" alt="image.png"></p> <ol><li>如果输入的是一个原始值，那么函数的结果就是直接返回本身。</li> <li>如果输入的是对象类型的值，且 preferredType 的值是 string ，那么就会先调用 <code>toString()</code> 得到返回值，如果该返回值还是引用数值那么还会继续调用 <code>valueOf()</code> 得到返回值，如果该返回值还是引用数值就会抛出一个TypeError的错误，否则返回这次的返回值。</li> <li>如果 preferredType 的值是 number ，那么调用的顺序和（2）的步骤相反，先调用 <code>valueOf()</code> ，再调用 <code>toString()</code> 方法，当然里面的结果判断都是和步骤2一致。</li> <li>如果缺少 preferredType， Date 类创建的实例对象隐式转换调用这个方法 preferredType 的值是string，其他引用数据隐式转换 preferredType 是number</li></ol> <p>下面举一个恰当的例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> x<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'valueof'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tostring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// tostring</span>
<span class="token comment">// valueof</span>
<span class="token comment">// Uncaught TypeError: Cannot convert object to primitive value</span>
</code></pre></div><p>从上述的结果可以看出当在调用 <code>String()</code> 方法显式转换的时候，此刻的 preferredType 值是string，会先调用 <code>toString()</code> 再调用 <code>valueOf()</code> 方法，当然最后的valueOf方法返回的是[] ,还是一个引用数值，所以会抛出 TypeError</p> <h3 id="tonumber"><a href="#tonumber" class="header-anchor">#</a> ToNumber()</h3> <p>在 非严格等 == 的操作数两边是不确定数据类型的，为了让两边能够正常的比较值，最终的结果比较往往是 <code>Number(x) == Number(y)</code>。</p> <p>该函数也是在 <a href="https://262.ecma-international.org/6.0/#sec-tonumber" target="_blank" rel="noopener noreferrer">ECMA文档  sec-tonumber<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中有详细的说明，简单的用一个表格来说明一下转换的结果。</p> <table><thead><tr><th>Argument Type</th> <th>Result</th></tr></thead> <tbody><tr><td>undefined</td> <td>NaN</td></tr> <tr><td>null</td> <td>+0</td></tr> <tr><td>boolean</td> <td>true is converted to 1, false is converted to +0</td></tr> <tr><td>string</td> <td>parse the number in the string. For example, &quot;324&quot; is converted to 324</td></tr> <tr><td>symbol</td> <td>TypeError: cannot convert a Symbol value to a number</td></tr> <tr><td>object</td> <td>ToPrimitive(obj, Number) and then applying ToNumber() to the (primitive) result.</td></tr></tbody></table> <p>下面针对表格中的特殊情况说明一下</p> <ol><li>引用数据类型在使用 <code>ToNumber()</code> 方法时会先调用 <code>ToPrimitive(obj, Number)</code> 尽可能的得到一个原始值，然后再把该原始值调用 <code>oNumber()</code> 得到结果</li></ol> <div class="language- extra-class"><pre class="language-text"><code>let y={
    valueOf(){
        console.log('valuey');
        return []
    },
    toString(){
        console.log('string');
        return '99'
    },
}

console.log(Number(y));
// valuey
// string
// 99
</code></pre></div><p>当然，上述调用的 <code>Number()</code> 函数是可以让用户显示调用 <code>ToNumber()</code> 的方法，通过结果可以看出对象是先调用了 <code>ToPrimitive()</code> 再将得到的原始值转换为number类型</p> <ol start="2"><li>symbol 类型在进行 ToNumber 操作时会报错，所以在进行 == 非严格等比较有 symbol 类型时如果不是和自身比较会直接等于 false</li></ol> <div class="language- extra-class"><pre class="language-text"><code>console.log(Symbol() == Symbol()); // false
console.log(Number(Symbol())); // Uncaught TypeError: Cannot convert a Symbol value to a number
</code></pre></div><h3 id="toboolean"><a href="#toboolean" class="header-anchor">#</a> ToBoolean()</h3> <p>当然，谈及隐式转换怎么能少得了 <code>ToBoolean()</code>，在日常开发中经常使用的 !x可是ToBoolean的杰作，关于 <code>ToBoolean</code> 的转换细节在<a href="https://262.ecma-international.org/6.0/#sec-toboolean" target="_blank" rel="noopener noreferrer">ECMAScript文档 -sec-toboolean<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中说明，下面用一个表格来说明它的转换结果。</p> <table><thead><tr><th>Argument Type</th> <th>Result</th></tr></thead> <tbody><tr><td>Undefined</td> <td>Return false.</td></tr> <tr><td>Null</td> <td>Return false.</td></tr> <tr><td>Boolean</td> <td>Return argument.</td></tr> <tr><td>Number</td> <td>Return false if argument is +0, −0, or NaN; otherwise return true.</td></tr> <tr><td>String</td> <td>Return false if argument is the empty String (its length is zero); otherwise return true.</td></tr> <tr><td>Symbol</td> <td>Return true.</td></tr> <tr><td>Object</td> <td>Return true.</td></tr></tbody></table> <p>特别注意的有以下几点：</p> <ol><li>所以对象转换结果都是 true</li> <li>Symbol 类型转换结果全都为true</li> <li>string类型只有空字符串转为false</li> <li>在数字进行 ToBoolean操作时，负数是会转换为 true 的，这在平时开发过程中需要注意。</li></ol> <p><code>Boolean(undefined) = true</code></p> <h2 id="场景分析"><a href="#场景分析" class="header-anchor">#</a> 场景分析</h2> <h3 id="严格等的比较分析"><a href="#严格等的比较分析" class="header-anchor">#</a> === 严格等的比较分析</h3> <p>在 === 比较时有一个重要的结论，</p> <blockquote><p>=== 不会进行隐式转换</p></blockquote> <p>所以对于a === b 严格等的规则对于 == 来说要简单的多，总结了一下，有以下几点</p> <div class="language- extra-class"><pre><code>Strict Equality Comparison
The comparison x === y, where x and y are values, produces true or false. Such a comparison is performed as follows:

If Type(x) is different from Type(y), return false.
If Type(x) is Number, then
a. If x is NaN, return false.
b. If y is NaN, return false.
c. If x is the same Number value as y, return true.
d. If x is +0 and y is ‐0,return true.
e. If x is ‐0 and y is +0, return true.
f. Return false.
Return SameValueNonNumber(x, y).
NOTE This algorithm differs from the SameValue Algorithm in its treatment of signed zeroes and NaNs.
</code></pre></div><p>上述的结论是<a href="https://262.ecma-international.org/6.0/#sec-strict-equality-comparison" target="_blank" rel="noopener noreferrer">ECMAScript文档 - sec-strict-equality-comparison <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>对于严格等的结论描述，简单的翻译一下有以下几点</p> <ol><li>a 和 b 的类型不同，一定返回false</li> <li>引用数值不是比较同一个引用情况直接返回 false</li> <li>同一个类型原始值值相等返回true，不相等返回 false</li> <li>symbol 类型的值只有和本身比较才为 true</li> <li>+0 和 -0 全等，返回 true</li></ol> <h3 id="抽象等的比较分析"><a href="#抽象等的比较分析" class="header-anchor">#</a> == 抽象等的比较分析</h3> <p>在分析之前，考一考你们下面的12个等式结果会是多少,因为在日常开发中通常会进行值判断，所以列举了很多与 boolean 值相转换的例子，希望在理解这些转换以后会对你的日常开发值判断有一些帮助。</p> <div class="language- extra-class"><pre class="language-text"><code>[] == true
![] == true
2 == true
'1' == true
-1 == false
[1] == '1'
!null == false
null == false
!'' == true
!'0' == true
'' == 0
'0' == 0
</code></pre></div><p>似曾相识的感觉，却又无法推理出正确的答案，不急，这就为你呈现上述的结果步骤</p> <p>对于抽象等而言，其中会多一个隐式转换的步骤，下面是<a href="https://262.ecma-international.org/6.0/#sec-abstract-equality-comparison" target="_blank" rel="noopener noreferrer">ECMAScript文档 sec-abstract-equality-comparison<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 对于抽象等的描述</p> <div class="language- extra-class"><pre><code>Abstract Equality Comparison
The comparison x == y, where x and y are values, produces true or false. Such a comparison is performed as follows:

ReturnIfAbrupt(x).
ReturnIfAbrupt(y).
If Type(x) is the same as Type(y), then
Return the result of performing Strict Equality Comparison x === y.
If x is null and y is undefined, return true.
If x is undefined and y is null, return true.
If Type(x) is Number and Type(y) is String,
return the result of the comparison x == ToNumber(y).
If Type(x) is String and Type(y) is Number,
return the result of the comparison ToNumber(x) == y.
If Type(x) is Boolean, return the result of the comparison ToNumber(x) == y.
If Type(y) is Boolean, return the result of the comparison x == ToNumber(y).
If Type(x) is either String, Number, or Symbol and Type(y) is Object, then
return the result of the comparison x == ToPrimitive(y).
If Type(x) is Object and Type(y) is either String, Number, or Symbol, then
return the result of the comparison ToPrimitive(x) == y.
Return false.
</code></pre></div><p>简单的翻译总结一下，有以下几点：</p> <ol><li>undefined 和 null 只有和 本身或者另一个null 或者 undefined 比较结果为true，其余的结果皆为 false</li> <li>Symbol只有和自身比较才为 true</li> <li><strong>不同类型的操作数两边比较将尽量转换为 <code>ToNumber(x)</code> 和 <code>ToNumber(y)</code>  的比较</strong></li> <li>相同类型的操作数比较会和 === 的结果保持一致。</li></ol> <p>上述的1 和 2 比较好理解，但是对于第三点来说左右两边的数据类型错综复杂，所以只要记住抽象等的结果会<strong>将是两个数字值的比较</strong>那么一切的问题都会变得简单起来。下面对于这点进行说明。</p> <ul><li>首先，对于两边是引用数据来说，和严格等的情况一致，不会进行显示转换。</li> <li>两边都是原始值类型会调用 ToNumber() 方法得到数值进行比较。</li> <li>一边是引用数值一边是引用数值，会先将引用数值调用 <code>ToPrimitive()</code> 方法转换为原始值，然后就会是两个原始值的比较。</li></ul> <h4 id="解析例子"><a href="#解析例子" class="header-anchor">#</a> 解析例子</h4> <h5 id="空数组比较"><a href="#空数组比较" class="header-anchor">#</a> 空数组比较</h5> <div class="language- extra-class"><pre class="language-text"><code>[] == true // false
![] == true // false
['1'] == 1 // true
</code></pre></div><p>对于上述的三个例子,都是一个数组和 boolean 值比较，但是它们的转换形式却完全不同，具体情况具体分析:</p> <ol><li>[] == true 的情况，左边是引用数据，右边是原始值，那么会先调用 <code>ToPrimitive()</code> 方法把[] 转换为''(先调用 valueOf 方法,再调用toString方法) ,接下来的结果就变成了 '' == true ;其次会再次调用 <code>ToNumber()</code> 方法进行比较，这样结果就变成了 <code>ToNumber('') == ToNumber(true)</code> ,按照上诉对 <code>ToNumber()</code> 的描述，结果就变成了 <code>0 == 1</code>，所以结果就是 false。</li> <li>![] == true 的情况，首先要明确的是取反操作符会隐式的调用 <code>toBoolean()</code> 方法得到一个确定的 boolean 值，还有一个点就是所有的对象转换为 boolean 一定是 true，所以![] 会变成 <code>!(toBoolean([])</code>,那么结果就会变成 <code>false == true</code> ，结果自然是 false。</li> <li><code>['1'] == 1</code> 的比较和第一个式子的转换方式特别相似。调用 <code>ToPrimitive()</code> 得到 <code>'1' == 1</code> ，然后再把 '1' 调用 <code>ToNumber()</code> 方法得到 <code>1 ==1</code>，结果为 true。</li></ol> <h5 id="原始值类型之间比较"><a href="#原始值类型之间比较" class="header-anchor">#</a> 原始值类型之间比较</h5> <div class="language- extra-class"><pre class="language-text"><code>2 == true // false
'1' == true // true
-1 == false // false
</code></pre></div><p>对于 string 类型和 boolean 类型来说，不是同一种类型的操作数会调用 <code>ToNumber()</code> 方法得到相对应的 number 类型再进行比较。例如在 <code>2 == true</code> 的比较中，true 是 boolean 类型的值，通过调用 <code>ToNumber(true)</code> 将会得到 1，最终的比较结果就是 <code>2 == 1</code>，答案自然是 false。同理，在第三例中，<code>ToNumber(false)</code> 的结果为0，最终比较结果为 <code>-1 == 0</code>，所以答案也是 false。</p> <h5 id="取反符号多作怪"><a href="#取反符号多作怪" class="header-anchor">#</a> !取反符号多作怪？</h5> <div class="language- extra-class"><pre class="language-text"><code>!null == false // false
null == false // false
!'' == true // true
!'0' == true // false
</code></pre></div><p>null 是一个比较特殊的值，代表原型链的顶端或者是表示此处不该有值，对于第二个例子，null 只能和undefined 或者 null非严格等，而不是去执行 <code>ToNumber(null)</code>。抛开第二个例子以外，其余的三个例子都和一个符号相关，取反符号!，接下来逐个分析。!null == false，!操作数的时候会将隐式的调用 <code>toBoolean(null)</code> 得到false(查表可得) 结果就变成了 !false ==false ，结果自然是false。对于第三个例子和第四个例子是同一个情况，都会先调用 <code>toBoolean()</code> 方法，不过需要<strong>注意</strong>的是，<code>toBoolean('0')</code> 的结果是 true，因为它是一个有具体内容的字符串，这一点我在开发的时候经常出错。</p> <h3 id="运算符的操作过程"><a href="#运算符的操作过程" class="header-anchor">#</a> + 运算符的操作过程</h3> <p>+号运算在日常开发中使用频率也比较高，大部分都是相同类型基本数据之间相加（当然这也是最符合规范的），但是如果不小心进行了不同类型的操作数的相加甚至是和对象相加呢，那这里面会碰撞出怎样的火花呢？假如以下几个例子的结果会是什么呢？</p> <div class="language- extra-class"><pre class="language-text"><code>2+[3,4]
[]+{}
{}+[]
{}+null
</code></pre></div><h4 id="加法运算步骤"><a href="#加法运算步骤" class="header-anchor">#</a> 加法运算步骤</h4> <ol><li>将 + 号运算符两边的引用值转换为原始值再相加</li> <li>原值值转换为 <code>ToNumber(x) + ToNumber(y)</code></li></ol> <h5 id="预设类型"><a href="#预设类型" class="header-anchor">#</a> 预设类型</h5> <p>首先，在 + 号运算中需要明确的是，+ 号运算两边是不确定左右操作数基本类型的，也就是说</p> <p><strong>如果一个运算无法确定类型，那么在类型转换前，它的运算数将被预设为 number</strong>。</p> <p>这个结论非常重要，它会直接影响到 <code>ToPrimitive</code> 函数的 <code>&lt;button&gt;&lt;/buttom&gt;</code> preferredType是number,然后将引用值转换为基础类型会先调用 <code>valueOf()</code> 再调用 <code>toString()</code> 方法。</p> <ul><li>[] 先调用 <code>valueOf()</code> 会得到本身 [] ,之后再调用 <code>toString()</code> 方法会得到''</li> <li>{} 先调用 <code>valueOf()</code> 会得到本身 {} ,调用 <code>toString()</code> 方法会得到 [object Object]</li> <li>[3,4] 和空数组不同的是,调用 <code>toString()</code> 方法会将里面的元素全部取出来再转换为字符串 '3,4'</li></ul> <h5 id="原始值的相加"><a href="#原始值的相加" class="header-anchor">#</a> 原始值的相加</h5> <p>当操作数两边都转换为基本数据类型的时候，事情就变得容易起来，只要数据类型不是number类型时就会去调用 <code>ToNumber()</code> 函数转换为 number 类型的值。例如下面的几个例子:</p> <div class="language- extra-class"><pre class="language-text"><code>null + undefined ?
false + true ?
Symbol()+Symbol() ?
</code></pre></div><p>根据上面的 ToNumber函数查表可以得到 <code>ToNumber(null) = 0</code> , <code>ToNumber(undefined) =NaN</code>, <code>ToNumber(false) = 0</code>, <code>ToNumber(true) = 1</code>, <code>ToNumber(Symbol())</code> 会抛出一个错误，所以最终的结果就是</p> <div class="language- extra-class"><pre class="language-text"><code>null + undefined = NaN
false + true = 1
Symbol()+Symbol()  TypeError: Cannot convert a Symbol value to a number
</code></pre></div><h5 id="字符串拼接"><a href="#字符串拼接" class="header-anchor">#</a> 字符串拼接</h5> <p>当然，在操作数相加过程中，难免会出现有字符串参与，不管是在引用值转换为基础值的过程中还是原本就是字符串，它的相加就会变成<strong>字符串相加</strong>，而且在相加过程只要有一个操作数变成了字符串类型那么就会拼接不管位置是前还是后。</p> <p>举一个简单的例子：</p> <div class="language- extra-class"><pre class="language-text"><code>const y={
    valueOf(){
        console.log('valueOf');
        return {}
    },
    toString(){
        console.log('toString');
        return '99'
    },
}
console.log(null + y) 
// valueOf
// toString
// null99
</code></pre></div><p>在上述的例子中，在 null 和 引用值 y 相加的时候，由于 y 是一个引用数据类型所以要先调用 <code>ToPrimitive(y)</code> 得到一个基本数据类型。由于在 + 号运算符中不知道运算类型会把 preferredType 预设为number，所以会先调用 <code>valueOf()</code> 方法再调用 <code>toString()</code> 方法得到了字符串 '99'。但是此处最为<strong>重要</strong>的是有两点：</p> <ul><li>判断是否执行完 <code>valueOf()</code> 方法 还继续执行 <code>toString()</code> 方法是根据 <code>valueOf()</code> 函数的返回值是否为引用数据类型而不是本身</li> <li>在判断是否进行字符串拼接也是根据 <code>valueOf()</code> 函数和 <code>toString()</code> 函数返回值是否是字符串类型。</li></ul> <h4 id="分析例子"><a href="#分析例子" class="header-anchor">#</a> 分析例子</h4> <div class="language- extra-class"><pre class="language-text"><code>2+[3,4] // 23,4
[]+{} // [object Object]
{}+[] // 0
{}+null // 0
</code></pre></div><p>在上面例子中包含了两种情况，分别是</p> <ul><li>包含引用数据类型的字符串拼接</li> <li>在 {} 开头的 加法处理</li></ul> <h5 id="字符串拼接情况"><a href="#字符串拼接情况" class="header-anchor">#</a> 字符串拼接情况</h5> <ul><li>在 [3,4] 和 2 相加的过程中，会把[3,4]转换为基本数据类型 '3,4'(通过调用ToPrimitive()),最后和2相加答案就是 23,4</li> <li>[] + {} 和上例的处理方式一致，唯一的区别就是在最后调用 <code>toString()</code> 方法的时候得到不同的值，[] 会得到空字符串，{} 会得到 '[object Object]'，所以最终的答案就是 [object Object]</li></ul> <h5 id="开头的处理"><a href="#开头的处理" class="header-anchor">#</a> {} 开头的处理</h5> <p>这里要特意的说明一下 {} + x 这样格式相加的例子，因为有一个比较重要的知识点</p> <p><strong>Automatic Semicolon Insertion (ASI)：自动分号插入</strong></p> <blockquote><p>自动分号插入是 javascript 设计史上最大的铁板</p></blockquote> <p>关于自动分号插入的具体可以参考这个<a href="https://2ality.com/2011/05/semicolon-insertion.html" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>上面的代码会变成</p> <div class="language- extra-class"><pre class="language-text"><code>{};+[]
{};+null
</code></pre></div><p>而且不幸的是这样的例子居然能够通过，所以最后的结果就会变成 +[] 和 +null。由于 + 号运算符能够明显的知道最终的结果要转换为number ,所以会直接调用 <code>toNumber([])</code> 和 <code>toNumber(null)</code>，参考前面所提及的 <code>toNumber</code> 函数转换规则，最终的答案就会变成 0 和 0。</p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>虽然 javascript 的隐式转换被后人一直诟病，后面也设计出一些可以进行数据类型检测的辅助语言 Typescript或者是 Flow，对于在可维护性和可读性上都有着非常大的提升。但是早期的 javascript语言对于 隐式转换所涉及的规范却是非常有意思的，这也许就是 Brendan Eich 在10天 通过借鉴 C语言、Java语言、Scheme语言、Self语言所设计出来的'混子语言'的魅力吧。</p> <blockquote><p>与其说我爱 Javascript，不如说我恨它。它是C语言和Self语言一夜情的产物。十八世纪英国文学家约翰逊博士说得好：'它的优秀之处并非原创，它的原创之处并不优秀。        - Brendan Eich</p></blockquote> <h2 id="参考链接"><a href="#参考链接" class="header-anchor">#</a> 参考链接</h2> <ul><li><a href="https://262.ecma-international.org/6.0/" target="_blank" rel="noopener noreferrer">ECMAScript-6.0文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://2ality.com/2012/01/object-plus-object.html" target="_blank" rel="noopener noreferrer">What is {} + {} in JavaScript?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://louiszhai.github.io/2015/12/11/js.boolean/" target="_blank" rel="noopener noreferrer">JS布尔值(Boolean)转换规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Equality_comparisons_and_sameness" target="_blank" rel="noopener noreferrer">JavaScript 中的相等性判断<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/LastKnightCoder/vuepress-blog/edit/master/docs/JavaScript/JS类型转换.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">October 15, 2021 03:40</span></div> <!----></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><div class="my-popup" style="display:none;" data-v-5f98aac3><div class="my-popup-container" data-v-5f98aac3><div class="my-popup-exit" data-v-5f98aac3></div> <img src="" alt data-v-5f98aac3></div></div></div></div>
    <script src="/assets/js/app.ae2d76ca.js" defer></script><script src="/assets/js/vendors~layout-Layout.8e38df49.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.f39ab126.js" defer></script><script src="/assets/js/page-非严格等和加法的'潜规则'.c3acfd97.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.778738f3.js" defer></script>
  </body>
</html>
